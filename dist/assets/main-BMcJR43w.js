import{c as q,g as O,d as E,a as L,b,o as Y,q as $,e as A,w as F,T as H,f as N}from"./main-Dj3Vhtkk.js";import{t as g,n as w,g as v,a as R,e as U,m as T,b as M}from"./en-US-BgDQTwAU.js";/* empty css                */function z(s,n){let e=s,r=n;const t=q(b,"chats");let c=null;const u=async f=>{const a=new Date,i={username:r,room:e,message:f,created_at:H.fromDate(a)};try{return await N(t,i)}catch(l){throw console.log("Error addchat = ",l),l}},o=f=>{c&&c(),c=Y($(t,F("room","==",e),A("created_at")),a=>{a.docChanges().forEach(i=>{i.type==="added"&&f(i.doc.data())})}),console.log(c)},d=f=>{e=f,console.log(`Room Changed to ${e}`)},m=f=>{r=f,localStorage.setItem("username",r),console.log(`Username changed to ${r}`)};return(()=>{let f=setInterval(async()=>{try{const a=await O(t);if(a.empty){console.log("No message to delete"),clearInterval(f);return}a.forEach(async i=>{await E(L(b,"chats",i.id))}),console.log("All messages deleted successfully.")}catch(a){console.error("Error deleting message : ",a)}},15e3)})(),{addChat:u,getChats:o,updateChatroom:d,updateUsername:m}}function y(s,n){const e=+g(s)-+g(n);return e<0?-1:e>0?1:e}function j(s,n,e){const[r,t]=w(e?.in,s,n),c=r.getFullYear()-t.getFullYear(),u=r.getMonth()-t.getMonth();return c*12+u}function k(s){return n=>{const r=(s?Math[s]:Math.trunc)(n);return r===0?0:r}}function G(s,n){return+g(s)-+g(n)}function B(s,n){const e=g(s,n?.in);return e.setHours(23,59,59,999),e}function J(s,n){const e=g(s,n?.in),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function K(s,n){const e=g(s,n?.in);return+B(e,n)==+J(e,n)}function P(s,n,e){const[r,t,c]=w(e?.in,s,s,n),u=y(t,c),o=Math.abs(j(t,c));if(o<1)return 0;t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-u*o);let d=y(t,c)===-u;K(r)&&o===1&&y(r,c)===1&&(d=!1);const m=u*(o-+d);return m===0?0:m}function Q(s,n,e){const r=G(s,n)/1e3;return k(e?.roundingMethod)(r)}function V(s,n,e){const r=R(),t=e?.locale??r.locale??U,c=2520,u=y(s,n);if(isNaN(u))throw new RangeError("Invalid time value");const o=Object.assign({},e,{addSuffix:e?.addSuffix,comparison:u}),[d,m]=w(e?.in,...u>0?[n,s]:[s,n]),h=Q(m,d),f=(v(m)-v(d))/1e3,a=Math.round((h-f)/60);let i;if(a<2)return e?.includeSeconds?h<5?t.formatDistance("lessThanXSeconds",5,o):h<10?t.formatDistance("lessThanXSeconds",10,o):h<20?t.formatDistance("lessThanXSeconds",20,o):h<40?t.formatDistance("halfAMinute",0,o):h<60?t.formatDistance("lessThanXMinutes",1,o):t.formatDistance("xMinutes",1,o):a===0?t.formatDistance("lessThanXMinutes",1,o):t.formatDistance("xMinutes",a,o);if(a<45)return t.formatDistance("xMinutes",a,o);if(a<90)return t.formatDistance("aboutXHours",1,o);if(a<T){const l=Math.round(a/60);return t.formatDistance("aboutXHours",l,o)}else{if(a<c)return t.formatDistance("xDays",1,o);if(a<M){const l=Math.round(a/T);return t.formatDistance("xDays",l,o)}else if(a<M*2)return i=Math.round(a/M),t.formatDistance("aboutXMonths",i,o)}if(i=P(m,d),i<12){const l=Math.round(a/M);return t.formatDistance("xMonths",l,o)}else{const l=i%12,x=Math.trunc(i/12);return l<3?t.formatDistance("aboutXYears",x,o):l<9?t.formatDistance("overXYears",x,o):t.formatDistance("almostXYears",x+1,o)}}function W(s){return{newli:e=>{const r=V(e.created_at.toDate(),new Date,{addSuffix:!0}),t=`
            <li class="shadow rounded-lg px-4 py-2" >
                <div class="flex justify-between" >
                    <h5 class="text-gray-600 font-medium text-sm" >${e.username}</h5>
                    <i class="text-gray-300 text-xs" >${r}</i>
                </div>
                <p class="text-gray-600 text-sm" >${e.message}</p>
            </li>
        `;s.innerHTML+=t}}}const Z=document.querySelector(".chatrooms"),ee=document.querySelector(".chat-ul"),S=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),I=document.querySelector(".msg"),_=document.querySelector(".roomtitle"),X=localStorage.username?localStorage.username:"Guest";D.username.placeholder=`Username is ${X}`;const p=z("general",X);_.textContent="General";const C=W(ee);S.addEventListener("submit",function(s){s.preventDefault();const n=S.message.value.trim();p.addChat(n).then(()=>S.reset()).catch(e=>{console.log(e)})});D.addEventListener("submit",function(s){s.preventDefault();const n=D.username.value.trim();p.updateUsername(n),D.reset(),I.innerText=`New name updated to ${n}`,D.username.placeholder=`username is ${n}`,setTimeout(()=>I.innerText="",3e3)});Z.addEventListener("click",function(s){s.preventDefault();const n=s.target.closest("button");if(n){C.resetli();const e=n.id,r=n.querySelector("h3").innerText;_.textContent=r,p.updateChatroom(e),p.getChats(t=>{C.newli(t)})}});
