import{c as q,g as L,d as O,a as E,b,o as Y,q as A,e as H,w as $,T as F,f as N}from"./main-uuQIQCJ2.js";import{t as g,n as w,g as v,a as R,e as U,m as T,b as M}from"./en-US-Bqq-q-Ln.js";/* empty css                */function z(s,n){let t=s,r=n;const e=q(b,"chats");let c=null;const l=async f=>{const a=new Date,i={username:r,room:t,message:f,created_at:F.fromDate(a)};try{return await N(e,i)}catch(u){throw console.log("Error addchat = ",u),u}},o=f=>{c&&c(),c=Y(A(e,$("room","==",t),H("created_at")),a=>{a.docChanges().forEach(i=>{i.type==="added"&&f(i.doc.data())})})},d=f=>{t=f},m=f=>{r=f,localStorage.setItem("username",r)};return(()=>{let f=setInterval(async()=>{try{const a=await L(e);if(a.empty){console.log("No message to delete"),clearInterval(f);return}a.forEach(async i=>{await O(E(b,"chats",i.id))}),console.log("All messages deleted successfully.")}catch(a){console.error("Error deleting message : ",a)}},15e3)})(),{addChat:l,getChats:o,updateChatroom:d,updateUsername:m}}function y(s,n){const t=+g(s)-+g(n);return t<0?-1:t>0?1:t}function j(s,n,t){const[r,e]=w(t?.in,s,n),c=r.getFullYear()-e.getFullYear(),l=r.getMonth()-e.getMonth();return c*12+l}function k(s){return n=>{const r=(s?Math[s]:Math.trunc)(n);return r===0?0:r}}function G(s,n){return+g(s)-+g(n)}function B(s,n){const t=g(s,n?.in);return t.setHours(23,59,59,999),t}function J(s,n){const t=g(s,n?.in),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function K(s,n){const t=g(s,n?.in);return+B(t,n)==+J(t,n)}function P(s,n,t){const[r,e,c]=w(t?.in,s,s,n),l=y(e,c),o=Math.abs(j(e,c));if(o<1)return 0;e.getMonth()===1&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-l*o);let d=y(e,c)===-l;K(r)&&o===1&&y(r,c)===1&&(d=!1);const m=l*(o-+d);return m===0?0:m}function Q(s,n,t){const r=G(s,n)/1e3;return k(t?.roundingMethod)(r)}function V(s,n,t){const r=R(),e=t?.locale??r.locale??U,c=2520,l=y(s,n);if(isNaN(l))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:l}),[d,m]=w(t?.in,...l>0?[n,s]:[s,n]),h=Q(m,d),f=(v(m)-v(d))/1e3,a=Math.round((h-f)/60);let i;if(a<2)return t?.includeSeconds?h<5?e.formatDistance("lessThanXSeconds",5,o):h<10?e.formatDistance("lessThanXSeconds",10,o):h<20?e.formatDistance("lessThanXSeconds",20,o):h<40?e.formatDistance("halfAMinute",0,o):h<60?e.formatDistance("lessThanXMinutes",1,o):e.formatDistance("xMinutes",1,o):a===0?e.formatDistance("lessThanXMinutes",1,o):e.formatDistance("xMinutes",a,o);if(a<45)return e.formatDistance("xMinutes",a,o);if(a<90)return e.formatDistance("aboutXHours",1,o);if(a<T){const u=Math.round(a/60);return e.formatDistance("aboutXHours",u,o)}else{if(a<c)return e.formatDistance("xDays",1,o);if(a<M){const u=Math.round(a/T);return e.formatDistance("xDays",u,o)}else if(a<M*2)return i=Math.round(a/M),e.formatDistance("aboutXMonths",i,o)}if(i=P(m,d),i<12){const u=Math.round(a/M);return e.formatDistance("xMonths",u,o)}else{const u=i%12,x=Math.trunc(i/12);return u<3?e.formatDistance("aboutXYears",x,o):u<9?e.formatDistance("overXYears",x,o):e.formatDistance("almostXYears",x+1,o)}}function W(s){return{newli:r=>{const e=V(r.created_at.toDate(),new Date,{addSuffix:!0}),c=`
            <li class="shadow rounded-lg px-4 py-2" >
                <div class="flex justify-between" >
                    <h5 class="text-gray-600 font-medium text-sm" >${r.username}</h5>
                    <i class="text-gray-300 text-xs" >${e}</i>
                </div>
                <p class="text-gray-600 text-sm" >${r.message}</p>
            </li>
        `;s.innerHTML+=c},resetli:()=>{s.innerHTML=""}}}const Z=document.querySelector(".chatrooms"),ee=document.querySelector(".chat-ul"),S=document.querySelector(".chat-form"),D=document.querySelector(".user-form"),I=document.querySelector(".msg"),C=document.querySelector(".roomtitle"),X=localStorage.username?localStorage.username:"Guest";D.username.placeholder=`Username is ${X}`;const p=z("general",X);C.textContent="General";const _=W(ee);S.addEventListener("submit",function(s){s.preventDefault();const n=S.message.value.trim();p.addChat(n).then(()=>S.reset()).catch(t=>{console.log(t)})});D.addEventListener("submit",function(s){s.preventDefault();const n=D.username.value.trim();p.updateUsername(n),D.reset(),I.innerText=`New name updated to ${n}`,D.username.placeholder=`username is ${n}`,setTimeout(()=>I.innerText="",3e3)});Z.addEventListener("click",function(s){s.preventDefault();const n=s.target.closest("button");if(n){_.resetli();const t=n.id,r=n.querySelector("h3").innerText;C.textContent=r,p.updateChatroom(t),p.getChats(e=>{_.newli(e)})}});
